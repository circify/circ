import "hashes/keccak/keccak";

def main() {
    // Python:
    // >>> from Crypto.Hash import keccak
    // >>> digest = keccak.new(digest_bits=256)
    // >>> digest.update(b'\x7a\x6f\x6b\x72\x61\x74\x65\x73')
    // >>> digest.hexdigest()
    // 'ca85d1976d40dcb6ca3becc8c6596e83c0774f4185cf016a05834f5856a37f39'

    u8[32] h1 = keccak::<_, 32>([0x7a, 0x6f, 0x6b, 0x72, 0x61, 0x74, 0x65, 0x73], 0x01);
    assert(h1 == [
        0xca, 0x85, 0xd1, 0x97, 0x6d, 0x40, 0xdc, 0xb6, 0xca, 0x3b, 0xec, 0xc8, 0xc6, 0x59, 0x6e, 0x83,
        0xc0, 0x77, 0x4f, 0x41, 0x85, 0xcf, 0x01, 0x6a, 0x05, 0x83, 0x4f, 0x58, 0x56, 0xa3, 0x7f, 0x39
    ]);

    // Python:
    // >>> from Crypto.Hash import keccak
    // >>> digest = keccak.new(digest_bits=256)
    // >>> digest.update(b'\x2a' * 135)
    // >>> digest.hexdigest()
    // '723e2ae02ca8d8fb45dca21e5f6369c4f124da72f217dca5e657a4bbc69b917d'

    u8[32] h2 = keccak::<_, 32>([0x2a; 135], 0x01);
    assert(h2 == [
        0x72, 0x3e, 0x2a, 0xe0, 0x2c, 0xa8, 0xd8, 0xfb, 0x45, 0xdc, 0xa2, 0x1e, 0x5f, 0x63, 0x69, 0xc4,
        0xf1, 0x24, 0xda, 0x72, 0xf2, 0x17, 0xdc, 0xa5, 0xe6, 0x57, 0xa4, 0xbb, 0xc6, 0x9b, 0x91, 0x7d
    ]);

    // Python:
    // >>> from Crypto.Hash import keccak
    // >>> digest = keccak.new(digest_bits=256)
    // >>> digest.update(b'\x2a' * 136)
    // >>> digest.hexdigest()
    // 'e60d5160227cb1b8dc8547deb9c6a2c5e6c3306a1ca155611a73ed2c2324bfc0'

    u8[32] h3 = keccak::<_, 32>([0x2a; 136], 0x01);
    assert(h3 == [
        0xe6, 0x0d, 0x51, 0x60, 0x22, 0x7c, 0xb1, 0xb8, 0xdc, 0x85, 0x47, 0xde, 0xb9, 0xc6, 0xa2, 0xc5,
        0xe6, 0xc3, 0x30, 0x6a, 0x1c, 0xa1, 0x55, 0x61, 0x1a, 0x73, 0xed, 0x2c, 0x23, 0x24, 0xbf, 0xc0
    ]);

    return;
}