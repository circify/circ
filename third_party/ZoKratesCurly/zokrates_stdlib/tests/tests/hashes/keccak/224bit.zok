import "hashes/keccak/224bit" as keccak224;

def main() {
    // Python:
    // >>> from Crypto.Hash import keccak
    // >>> digest = keccak.new(digest_bits=224)
    // >>> digest.update(b'\x2a')
    // >>> digest.hexdigest()
    // '69d40b3f7b3118a1fb193b518a70f279348e4f0835553f37d85f436a'

    u8[28] h1 = keccak224::<1>([0x2a]);
    assert(h1 == [
        0x69, 0xd4, 0x0b, 0x3f, 0x7b, 0x31, 0x18, 0xa1, 0xfb, 0x19, 0x3b, 0x51, 0x8a, 0x70,
        0xf2, 0x79, 0x34, 0x8e, 0x4f, 0x08, 0x35, 0x55, 0x3f, 0x37, 0xd8, 0x5f, 0x43, 0x6a
    ]);

    // Python:
    // >>> from Crypto.Hash import keccak
    // >>> digest = keccak.new(digest_bits=224)
    // >>> digest.update(b'\x2a' * 8)
    // >>> digest.hexdigest()
    // '463b45a39816aeba7c62a75aed7acaaf11f7646217512a2f992ddce0'

    u8[28] h2 = keccak224::<8>([0x2a; 8]);
    assert(h2 == [
        0x46, 0x3b, 0x45, 0xa3, 0x98, 0x16, 0xae, 0xba, 0x7c, 0x62, 0xa7, 0x5a, 0xed, 0x7a,
        0xca, 0xaf, 0x11, 0xf7, 0x64, 0x62, 0x17, 0x51, 0x2a, 0x2f, 0x99, 0x2d, 0xdc, 0xe0
    ]);

    // Python:
    // >>> from Crypto.Hash import keccak
    // >>> input = "hello world".encode()
    // >>> input.hex()
    // '68656c6c6f20776f726c64'
    // >>> digest = keccak.new(digest_bits=224)
    // >>> digest.update(input)
    // >>> digest.hexdigest()
    // '25f3ecfebabe99686282f57f5c9e1f18244cfee2813d33f955aae568'

    u8[28] h3 = keccak224::<11>([0x68, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64]);
    assert(h3 == [
        0x25, 0xf3, 0xec, 0xfe, 0xba, 0xbe, 0x99, 0x68, 0x62, 0x82, 0xf5, 0x7f, 0x5c, 0x9e,
        0x1f, 0x18, 0x24, 0x4c, 0xfe, 0xe2, 0x81, 0x3d, 0x33, 0xf9, 0x55, 0xaa, 0xe5, 0x68
    ]);

    return;
}